# 편의점

**재고 관리 설정**

> 프로모션 재고 우선 차감
> - 프로모션 기간이 아닐 경우 프로모션 재고도 일반 재고 취급하고 프로모션 재고를 우선적으로 차감한다.
> - 프로모션 기간에 프로모션 개수를 채우지 못할 경우, 해당 개수 만큼 프로모션 재고를 먼저 사용한다?
    >

- `ex)2+1 프로모션 기간에 1개만 구입 원할 경우, 1개를 프로모션 재고에서 차감한다.`

>
> 동일 상품에 여러 프로모션이 적용되지 않는다.
> - 동일 상품에 대해서는 최대 두 가지 상품 종류만 존재함

# ✅ 기능 목록 정리

### **⚙️ Model**

- **재고 관리자**
- [x] 구매 상품 구매 응답 반환 기능
    - [x] 재고들 중 구매 상품 품목을 찾습니다.
    - [x] 해당 품목의 품목 검사를 실시하고 구매 응답을 반환합니다.
    - [x] 존재하지 않는 상품을 입력받은 경우, 예외를 발생시킨다.
    - [x] 구매 수량이 재고의 수량을 초과한 경우, 예외를 발생시킨다.
- [x] 재고 상태를 불러오는 기능
    - [x] 프로모션 유무에 따라 상품의 종류를 달리하여 저장합니다.
- [x] 행사 목록을 불러오는 기능.
- [ ] 재고 상태를 최신화 하는 기능

재고 상태, 상품 목록 : `products.md`

**품목 검사**

- [x] 해당 품목 상품들의 재고상황에 따른 구매 응답을 반환하는 기능
    - [x] 해당 상품의 재고가 부족할 경우, 재고 부족 응답을 반환합니다.
    - [x] 해당 품목에 프로모션 상품이 있는 경우, 프로모션 상품 재고를 먼저 검사합니다.
        - [x] 해당 품목의 프로모션 정보에 따라 요청 수량에 따른 구매 응답을 반환합니다.
    - [x] 구매 가능할 경우, 정상 구매 응답을 반환합니다.

**일반 상품**

- [x] 이름 확인 기능
- [x] 구매 가능 여부 확인 기능
    - [x] 구매 가능할 경우, 정상 구매 응답을 반환합니다.
    - [x] 재고가 부족할 경우, 재고 부족 응답을 반환합니다.
- [x] 재고 차감 기능
- [x] 상품 정보를 생성하는 기능

**프로모션 상품**

- [x] 이름 확인 기능
- [x] 구매 가능 여부 확인 기능
    - [x] 프로모션 기간이 아닐 경우, 전체 요청 수량에 대한 정상 결제 안내 응답을 반환합니다.
    - [x] 프로모션 적용에 따른 구매 응답을 반환합니다.
- [x] 재고 차감 기능
- [x] 상품 정보를 생성하는 기능

**프로모션**

- [x] 프로모션 유효 기간 검사 기능
    - [x] 오늘 날짜가 프로모션 기간에 포함되는지 검사합니다.
- [x] 프로모션 구매 응답 기능
    - [x] 요청 수량과 재고 수량을 고려하여 프로모션 적용에 따른 구매 코드, 적용 횟수, 남은 수량을 반환합니다.
    - [x] 요청 수량이 프로모션 할인 수량 보다 적은 경우, 추가 수량 요청 응답을 반환합니다.
    - [x] 재고가 부족하여 일부 수량을 프로모션 혜택 없이 결제해야 하는 경우, 일부 수량 정가 구매 요청 응답을 반환합니다.
    - [x] 구매 가능할 경우, 정상 구매 응답을 반환합니다.

**🤔 프로모션 적용 케이스 정리**

`2+1` 프로모션 에서 요청 수량 4개에 대하여

- ex) 6개 (2+1,2+1)로 보는 경우 2개 추가 수량 요청 -> (x)
- ex) 4개 (2+1, 1)로 보는 경우 1개 정상 결제 안내 -> (o)

> 추가 수령 요청 메세지에서 `1개`를 명시함에 따라 추가 수량 요청은 `1개`만 허용하는 것으로 한다.

`N+1` 프로모션 에서 요청 수량 N개 프로모션 재고 N개인 경우

- N개 정상 결제 안내

> 프로모션 재고 부족에 대한 메세지를 추가하지 않고 기존의 정상 결제 안내 메세지로 통일한다.

프로모션 기간이 아닌 경우

- 프로모션 재고를 일반 재고로 취급 프로모션 재고를 우선적으로 차감
- 요청 수량에 대해 정상 결제 안내

> 프로모션 기간에 대한 메세지를 추가하지 않고 기존의 정상 결제 안내 메세지로 통일한다.

### **💻 View**

**입력**

- [x] 사용자 입력 요청 메세지 출력 및 입력을 받는 기능
    - [x] 구매할 상품과 수량을 입력 받습니다.
    - [x] 프로모션 증정 상품 추가 여부를 입력 받습니다.
    - [x] 일부 수량 정가 결제 여부를 입력 받습니다.
    - [x] 맴버십 할인 적용 여부를 입력 받습니다.
    - [x] 추가 구매 여부를 입력 받습니다.

## **📝 요구 사항**

**재고 관리 요구사항**

구매 수량이 재고 수량을 초과한 경우:
<br>`[ERROR] 재고 수량을 초과하여 구매할 수 없습니다. 다시 입력해 주세요.`
<br>존재하지 않는 상품을 입력한 경우:
<br>`[ERROR] 존재하지 않는 상품입니다. 다시 입력해 주세요.`

- 각 상품의 재고 수량을 고려하여 결제 가능 여부를 확인한다.
- 고객이 상품을 구매할 때마다, 결제된 수량만큼 해당 상품의 재고에서 차감하여 수량을 관리한다.
- 재고를 차감함으로써 시스템은 최신 재고 상태를 유지하며, 다음 고객이 구매할 때 정확한 재고 정보를 제공한다.

**프로모션 할인 요구 사항**

- 오늘 날짜가 프로모션 기간 내에 포함된 경우에만 할인을 적용한다.
- 프로모션은 N개 구매 시 1개 무료 증정(Buy N Get 1 Free)의 형태로 진행된다.
- 1+1 또는 2+1 프로모션이 각각 지정된 상품에 적용되며, 동일 상품에 여러 프로모션이 적용되지 않는다.
- 프로모션 혜택은 프로모션 재고 내에서만 적용할 수 있다.
- 프로모션 기간 중이라면 프로모션 재고를 우선적으로 차감하며, 프로모션 재고가 부족할 경우에는 일반 재고를 사용한다.
- 프로모션 적용이 가능한 상품에 대해 고객이 해당 수량보다 적게 가져온 경우,
    - 필요한 수량을 추가로 가져오면 혜택을 받을 수 있음을 안내한다.
- 프로모션 재고가 부족하여 일부 수량을 프로모션 혜택 없이 결제해야 하는 경우,
    - 일부 수량에 대해 정가로 결제하게 됨을 안내한다.
